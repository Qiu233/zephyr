module JceTest where
import Zephyr.Utils.Common (decodeHex_)
import Zephyr.Utils.Jce (jceUnmarshal)
import Zephyr.Packet.Jce.FileStoragePushFSSvcList
import Zephyr.Packet.Jce.BigData
import Test.Hspec

jceTest = do
    describe "jce tests" $ do
        it "ad-hoc1" $ do
            let bs = decodeHex_ "0900050A00011900040A0001160D3132302E3233322E32342E3234211F900B0A0001160E3132302E3233322E33312E323532211F900B0A0001160D3131312E33302E3137302E363120500B0A0001160D33362E3135352E3230382E37362101BB0B290C3C0B0A00051900040A0001160D3132302E3233322E32342E3234211F900B0A0001160E3132302E3233322E33312E323532211F900B0A0001160D3131312E33302E3137302E363120500B0A0001160D33362E3135352E3230382E37362101BB0B290C3C0B0A000A1900040A0001160D3132302E3233322E32342E3234211F900B0A0001160E3132302E3233322E33312E323532211F900B0A0001160D3131312E33302E3137302E363120500B0A0001160D33362E3135352E3230382E37362101BB0B2900050A0C114000201030010B0A0001112000200830020B0A0002112000200830010B0A0003112000200830020B0A0004112000200830020B3C0B0A00151900040A0001160D3132302E3233332E31392E37302101BB0B0A0001160D33362E3135352E3232342E32302101BB0B0A0001160E3132302E3233322E3133302E38322101BB0B0A0001160D3131312E33302E3136392E32312101BB0B290C3C0B0A00151900040A0001160D3132302E3233332E31392E37302101BB0B0A0001160D33362E3135352E3232342E32302101BB0B0A0001160E3132302E3233322E3133302E38322101BB0B0A0001160D3131312E33302E3136392E32312101BB0B290C3C0B1D000068A73029140B91B39730682D0BF297E79FDE2AB9BDAA384361BF8DC5976B428B9D6660F36E6BB294CE8C55E4D95753AF069A3F2D8902423FB6A85E4E895E26222F1995816D145AAAA853A1511B81E105E6F9D2365F2C7B641F92B28FFABD2539746DD97C16B6CE70092D00001036426B394E445843656B787078326E61326BD640C040015D0001057A8A50F60A0A68A73029140B91B39730682D0BF297E79FDE2AB9BDAA384361BF8DC5976B428B9D6660F36E6BB294CE8C55E4D95753AF069A3F2D8902423FB6A85E4E895E26222F1995816D145AAAA853A1511B81E105E6F9D2365F2C7B641F92B28FFABD2539746DD97C16B6CE7009121036426B394E445843656B787078326E611AD2010801120E08011578E8181818903F20012801120E08011578E81FFC18903F20012801120D0801156F1EAA3D185020022800120E080115249BD04C18BB03200428002A1B0801121024098C5408713001000000000000002B18903F200128002A1B0801121024098C5408713003000000000000001D18903F200128002A1B080112102409870248601001000000000000000B18903F200128002A1B0801121024098C1E75B01120000000000000002918903F200428002A1B08011210240E097C002F3000000000000000002018903F200128001AD2010805120E08011578E8181818903F20012801120E08011578E81FFC18903F20012801120D0801156F1EAA3D185020022800120E080115249BD04C18BB03200428002A1B0801121024098C5408713001000000000000002B18903F200128002A1B0801121024098C5408713003000000000000001D18903F200128002A1B080112102409870248601001000000000000000B18903F200128002A1B0801121024098C1E75B01120000000000000002918903F200428002A1B08011210240E097C002F3000000000000000002018903F200128001A8A02080A120E08011578E8181818903F20012801120E08011578E81FFC18903F20012801120D0801156F1EAA3D185020022800120E080115249BD04C18BB0320042800220A0800108080011810200122090801108040180820022209080210804018082001220908031080401808200222090804108040180820022A1B0801121024098C5408713001000000000000002B18903F200128002A1B0801121024098C5408713003000000000000001D18903F200128002A1B080112102409870248601001000000000000000B18903F200128002A1B0801121024098C1E75B01120000000000000002918903F200428002A1B08011210240E097C002F3000000000000000002018903F200128001AB6010815120E08011578E9134618BB0320012801120E080115249BE01418BB0320012801120E08011578E8825218BB0320012800120E0801156F1EA91518BB03200128002A1B0801121024098C5408710004000000000000004218BB03200128002A1B0801121024098C2008180115000000000000003818BB03200128002A1B080112102409870248600105000000000000005518BB03200128002A1B08011210240E097C002F0005000000000000007018BB03200128001AB6010815120E08011578E9134618BB0320012801120E080115249BE01418BB0320012801120E08011578E8825218BB0320012800120E0801156F1EA91518BB03200128002A1B0801121024098C5408710004000000000000004218BB03200128002A1B0801121024098C2008180115000000000000003818BB03200128002A1B080112102409870248600105000000000000005518BB03200128002A1B08011210240E097C002F0005000000000000007018BB032001280020013204080010013A2A0810101018092009280F300F38054005485A5001585A605A685A705A780A80010A88010A90010A98010A420A080010001800200028004A0608011001180352420801120A08001080800418102002120A08011080800418082002120A08021080800118082001120A08031080800218082002120A08041080800418082002180020005A3C0801120A0800108080041810200212090801108040180820021209080210804018082001120908031080401808200212090804108040180820021800700278038001000B6900010A162D696D6763616368652E71712E636F6D2E73636865642E6C65676F706963312D646B2E74646E7376362E636F6D2E20500B7900020A160E3232332E3130392E3231392E353220500B0A160E3232332E3130392E3231392E353420500B8A060D3232332E37342E34342E32303510080B9A0900070A00041900010A12302E337920500B290C0B0A00071900010A12625D337920500B290C0B0A00091900020A12C721E87820500B0A123244E87820500B290C0B0A000A1900020A12C421E87820500B0A120F44E87820500B290C0B0A00051900010A121A10F17820500B290C0B0A00081900020A125F26E97820500B0A126026E97820500B290C0B0A00061900020A12F8D29B2420500B0A12B3CE9B2420500B290C0B0BAD0001015C08011093E4C6BF0F1800220A3138303932303333393228DF95B1E90C321208F8D2CBC9091050188BF6C68C0C20502864321208F8D2CBE90F1050188990E2DA0A20502864321308A4B6B2DF0B1050188BE89AE30E205028C801321308A4B6B2D70A1050188BE89A9B0B205028C801321308B7DF9CB308105018899082F809205028AC02321308B7DFB8A30D1050188BF6C6BC03205028AC023A1E0A1024098C540871000000000000000000A41050188990E2C205205028643A1E0A1024098C540871000100000000000000511050188990E68A0B205028643A1F0A1024098C200818011500000000000000831050188BE892830D205028C8013A1F0A1024098C200818011400000000000000671050188BE89ECB01205028C8013A1F0A1024024E001020106F00009779544AE3F11050188990EAFA05205028AC023A1F0A1024024E001020106F00009779545D0B8F1050188990E6F203205028AC02"
            let v = jceUnmarshal bs :: BigDataChannel
            print v
        it "ad-hoc" $ do
            let bs = decodeHex_ "0900050A160F3132302E3139382E3138382E313530211F900B0A160E3138332E3233322E3132372E3239211F900B0A160E3138332E3233322E3132372E3330211F900B0A160E3138332E3233322E3132372E3331211F900B0A160E3138332E3233322E3132372E3332211F900B1900020A160F3132302E3139362E3231302E31303720500B0A160E3138332E3233322E38382E31383820500B2900020A160D3138332E3230342E31342E323820500B0A160D33362E3135352E3234302E393920500B3900050A160E3232312E3137392E31382E31373620500B0A160E3232312E3137392E31382E31373820500B0A160E3232312E3137392E31382E31383020500B0A160E3232312E3137392E31382E31383220500B0A16117363616E6E6F6E2E33672E71712E636F6D20500B4900040A160D3132302E3233322E32342E3234211F900B0A160E3132302E3233322E33312E323532211F900B0A160D3131312E33302E3137302E363120500B0A160D33362E3135352E3230382E37362101BB0B5A0900050A00011900040A0001160D3132302E3233322E32342E3234211F900B0A0001160E3132302E3233322E33312E323532211F900B0A0001160D3131312E33302E3137302E363120500B0A0001160D33362E3135352E3230382E37362101BB0B290C3C0B0A00051900040A0001160D3132302E3233322E32342E3234211F900B0A0001160E3132302E3233322E33312E323532211F900B0A0001160D3131312E33302E3137302E363120500B0A0001160D33362E3135352E3230382E37362101BB0B290C3C0B0A000A1900040A0001160D3132302E3233322E32342E3234211F900B0A0001160E3132302E3233322E33312E323532211F900B0A0001160D3131312E33302E3137302E363120500B0A0001160D33362E3135352E3230382E37362101BB0B2900050A0C114000201030010B0A0001112000200830020B0A0002112000200830010B0A0003112000200830020B0A0004112000200830020B3C0B0A00151900040A0001160D3132302E3233332E31392E37302101BB0B0A0001160D33362E3135352E3232342E32302101BB0B0A0001160E3132302E3233322E3133302E38322101BB0B0A0001160D3131312E33302E3136392E32312101BB0B290C3C0B0A00151900040A0001160D3132302E3233332E31392E37302101BB0B0A0001160D33362E3135352E3232342E32302101BB0B0A0001160E3132302E3233322E3133302E38322101BB0B0A0001160D3131312E33302E3136392E32312101BB0B290C3C0B1D000068A73029140B91B39730682D0BF297E79FDE2AB9BDAA384361BF8DC5976B428B9D6660F36E6BB294CE8C55E4D95753AF069A3F2D8902423FB6A85E4E895E26222F1995816D145AAAA853A1511B81E105E6F9D2365F2C7B641F92B28FFABD2539746DD97C16B6CE70092D00001036426B394E445843656B787078326E61326BD640C040015D0001057A8A50F60A0A68A73029140B91B39730682D0BF297E79FDE2AB9BDAA384361BF8DC5976B428B9D6660F36E6BB294CE8C55E4D95753AF069A3F2D8902423FB6A85E4E895E26222F1995816D145AAAA853A1511B81E105E6F9D2365F2C7B641F92B28FFABD2539746DD97C16B6CE7009121036426B394E445843656B787078326E611AD2010801120E08011578E8181818903F20012801120E08011578E81FFC18903F20012801120D0801156F1EAA3D185020022800120E080115249BD04C18BB03200428002A1B0801121024098C5408713001000000000000002B18903F200128002A1B0801121024098C5408713003000000000000001D18903F200128002A1B080112102409870248601001000000000000000B18903F200128002A1B0801121024098C1E75B01120000000000000002918903F200428002A1B08011210240E097C002F3000000000000000002018903F200128001AD2010805120E08011578E8181818903F20012801120E08011578E81FFC18903F20012801120D0801156F1EAA3D185020022800120E080115249BD04C18BB03200428002A1B0801121024098C5408713001000000000000002B18903F200128002A1B0801121024098C5408713003000000000000001D18903F200128002A1B080112102409870248601001000000000000000B18903F200128002A1B0801121024098C1E75B01120000000000000002918903F200428002A1B08011210240E097C002F3000000000000000002018903F200128001A8A02080A120E08011578E8181818903F20012801120E08011578E81FFC18903F20012801120D0801156F1EAA3D185020022800120E080115249BD04C18BB0320042800220A0800108080011810200122090801108040180820022209080210804018082001220908031080401808200222090804108040180820022A1B0801121024098C5408713001000000000000002B18903F200128002A1B0801121024098C5408713003000000000000001D18903F200128002A1B080112102409870248601001000000000000000B18903F200128002A1B0801121024098C1E75B01120000000000000002918903F200428002A1B08011210240E097C002F3000000000000000002018903F200128001AB6010815120E08011578E9134618BB0320012801120E080115249BE01418BB0320012801120E08011578E8825218BB0320012800120E0801156F1EA91518BB03200128002A1B0801121024098C5408710004000000000000004218BB03200128002A1B0801121024098C2008180115000000000000003818BB03200128002A1B080112102409870248600105000000000000005518BB03200128002A1B08011210240E097C002F0005000000000000007018BB03200128001AB6010815120E08011578E9134618BB0320012801120E080115249BE01418BB0320012801120E08011578E8825218BB0320012800120E0801156F1EA91518BB03200128002A1B0801121024098C5408710004000000000000004218BB03200128002A1B0801121024098C2008180115000000000000003818BB03200128002A1B080112102409870248600105000000000000005518BB03200128002A1B08011210240E097C002F0005000000000000007018BB032001280020013204080010013A2A0810101018092009280F300F38054005485A5001585A605A685A705A780A80010A88010A90010A98010A420A080010001800200028004A0608011001180352420801120A08001080800418102002120A08011080800418082002120A08021080800118082001120A08031080800218082002120A08041080800418082002180020005A3C0801120A0800108080041810200212090801108040180820021209080210804018082001120908031080401808200212090804108040180820021800700278038001000B6900010A162D696D6763616368652E71712E636F6D2E73636865642E6C65676F706963312D646B2E74646E7376362E636F6D2E20500B7900020A160E3232332E3130392E3231392E353220500B0A160E3232332E3130392E3231392E353420500B8A060D3232332E37342E34342E32303510080B9A0900070A00041900010A12302E337920500B290C0B0A00071900010A12625D337920500B290C0B0A00091900020A12C721E87820500B0A123244E87820500B290C0B0A000A1900020A12C421E87820500B0A120F44E87820500B290C0B0A00051900010A121A10F17820500B290C0B0A00081900020A125F26E97820500B0A126026E97820500B290C0B0A00061900020A12F8D29B2420500B0A12B3CE9B2420500B290C0B0BAD0001015C08011093E4C6BF0F1800220A3138303932303333393228DF95B1E90C321208F8D2CBC9091050188BF6C68C0C20502864321208F8D2CBE90F1050188990E2DA0A20502864321308A4B6B2DF0B1050188BE89AE30E205028C801321308A4B6B2D70A1050188BE89A9B0B205028C801321308B7DF9CB308105018899082F809205028AC02321308B7DFB8A30D1050188BF6C6BC03205028AC023A1E0A1024098C540871000000000000000000A41050188990E2C205205028643A1E0A1024098C540871000100000000000000511050188990E68A0B205028643A1F0A1024098C200818011500000000000000831050188BE892830D205028C8013A1F0A1024098C200818011400000000000000671050188BE89ECB01205028C8013A1F0A1024024E001020106F00009779544AE3F11050188990EAFA05205028AC023A1F0A1024024E001020106F00009779545D0B8F1050188990E6F203205028AC02"
            let v = jceUnmarshal bs :: FileStoragePushFSSvcList
            print v